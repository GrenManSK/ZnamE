<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ZnamE: system_operations Namespace Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ZnamE<span id="projectnumber">&#160;v1.3.0-alpha+build.20230430.155859</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('de/d05/namespacesystem__operations.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">system_operations Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae1c540b83755223d324045f0383ce68d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d05/namespacesystem__operations.html#ae1c540b83755223d324045f0383ce68d">getWindow</a> (args)</td></tr>
<tr class="separator:ae1c540b83755223d324045f0383ce68d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3fb45e81ca75b65dfa7ad1c6819300c"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d05/namespacesystem__operations.html#aa3fb45e81ca75b65dfa7ad1c6819300c">isUserAdmin</a> ()</td></tr>
<tr class="separator:aa3fb45e81ca75b65dfa7ad1c6819300c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad91b2c3c346993d5f478e23670f61aeb"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d05/namespacesystem__operations.html#ad91b2c3c346993d5f478e23670f61aeb">runAsAdmin</a> (cmdLine=None, wait=True)</td></tr>
<tr class="separator:ad91b2c3c346993d5f478e23670f61aeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d29427becb76cd67d51fe071b7aa721"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d05/namespacesystem__operations.html#a2d29427becb76cd67d51fe071b7aa721">checkAdmin</a> ()</td></tr>
<tr class="separator:a2d29427becb76cd67d51fe071b7aa721"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7f6f1490c9ace89a495ec832aba1be5"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d05/namespacesystem__operations.html#ab7f6f1490c9ace89a495ec832aba1be5">getImg</a> (str imgSrc, str name, x=None, y=None, width=None, length=None)</td></tr>
<tr class="separator:ab7f6f1490c9ace89a495ec832aba1be5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a2d29427becb76cd67d51fe071b7aa721" name="a2d29427becb76cd67d51fe071b7aa721"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d29427becb76cd67d51fe071b7aa721">&#9670;&#160;</a></span>checkAdmin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def system_operations.checkAdmin </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">The checkAdmin function checks if the user is an admin. If not, it will run the program as an admin.
:return: 0 if the user is an admin, and returns 1 if the user is not an admin
:doc-author: Trelent
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/d18/system__operations_8py_source.html#l00117">117</a> of file <a class="el" href="../../dd/d18/system__operations_8py_source.html">system_operations.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  117</span><span class="keyword">def </span>checkAdmin():</div>
<div class="line"><span class="lineno">  118</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  119</span><span class="stringliteral">    The checkAdmin function checks </span><span class="keywordflow">if</span> the user <span class="keywordflow">is</span> an admin. If <span class="keywordflow">not</span>, it will run the program <span class="keyword">as</span> an admin.</div>
<div class="line"><span class="lineno">  120</span>    :<span class="keywordflow">return</span>: 0 <span class="keywordflow">if</span> the user <span class="keywordflow">is</span> an admin, <span class="keywordflow">and</span> returns 1 <span class="keywordflow">if</span> the user <span class="keywordflow">is</span> <span class="keywordflow">not</span> an admin</div>
<div class="line"><span class="lineno">  121</span>    :doc-author: Trelent</div>
<div class="line"><span class="lineno">  122</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  123</span><span class="stringliteral">    rc = 0</span></div>
<div class="line"><span class="lineno">  124</span><span class="stringliteral">    </span><span class="keywordflow">if</span> <span class="keywordflow">not</span> isUserAdmin():</div>
<div class="line"><span class="lineno">  125</span>        print(<span class="stringliteral">&quot;You&#39;re not an admin.&quot;</span>,</div>
<div class="line"><span class="lineno">  126</span>              os.getpid(), <span class="stringliteral">&quot;params: &quot;</span>, sys.argv)</div>
<div class="line"><span class="lineno">  127</span>        rc = runAsAdmin()</div>
<div class="line"><span class="lineno">  128</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  129</span>        print(<span class="stringliteral">&quot;You are an admin!&quot;</span>, os.getpid(),</div>
<div class="line"><span class="lineno">  130</span>              <span class="stringliteral">&quot;params: &quot;</span>, sys.argv)</div>
<div class="line"><span class="lineno">  131</span>        rc = 0</div>
<div class="line"><span class="lineno">  132</span>    <span class="keywordflow">return</span> rc</div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  134</span> </div>
</div><!-- fragment --><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../de/d05/namespacesystem__operations_a2d29427becb76cd67d51fe071b7aa721_cgraph.png" border="0" usemap="#ade/d05/namespacesystem__operations_a2d29427becb76cd67d51fe071b7aa721_cgraph" alt=""/></div>
</div>

</div>
</div>
<a id="ab7f6f1490c9ace89a495ec832aba1be5" name="ab7f6f1490c9ace89a495ec832aba1be5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7f6f1490c9ace89a495ec832aba1be5">&#9670;&#160;</a></span>getImg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None system_operations.getImg </td>
          <td>(</td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>imgSrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>width</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>length</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">The getImg function displays an image from the source. If x, y, width, and length are specified, then the image will be displayed at those coordinates with the specified width and length. Otherwise, the image will be displayed at the default coordinates and default width and length.

:param imgSrc: str: Specify the source of the image
:param name: str: Name the window
:param x: Set the x coordinate of the window
:param y: Specify the y coordinate of the window
:param width: Set the width of the window
:param length: Set the length of the window
:return: The image that is displayed
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/d18/system__operations_8py_source.html#l00135">135</a> of file <a class="el" href="../../dd/d18/system__operations_8py_source.html">system_operations.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  135</span><span class="keyword">def </span>getImg(imgSrc: str, name: str, x=<span class="keywordtype">None</span>, y=<span class="keywordtype">None</span>, width=<span class="keywordtype">None</span>, length=<span class="keywordtype">None</span>) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  136</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  137</span><span class="stringliteral">    The getImg function displays an image </span><span class="keyword">from</span> the source. If x, y, width, <span class="keywordflow">and</span> length are specified, then the image will be displayed at those coordinates <span class="keyword">with</span> the specified width <span class="keywordflow">and</span> length. Otherwise, the image will be displayed at the default coordinates <span class="keywordflow">and</span> default width <span class="keywordflow">and</span> length.</div>
<div class="line"><span class="lineno">  138</span> </div>
<div class="line"><span class="lineno">  139</span>    :param imgSrc: str: Specify the source of the image</div>
<div class="line"><span class="lineno">  140</span>    :param name: str: Name the window</div>
<div class="line"><span class="lineno">  141</span>    :param x: Set the x coordinate of the window</div>
<div class="line"><span class="lineno">  142</span>    :param y: Specify the y coordinate of the window</div>
<div class="line"><span class="lineno">  143</span>    :param width: Set the width of the window</div>
<div class="line"><span class="lineno">  144</span>    :param length: Set the length of the window</div>
<div class="line"><span class="lineno">  145</span>    :<span class="keywordflow">return</span>: The image that <span class="keywordflow">is</span> displayed</div>
<div class="line"><span class="lineno">  146</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  147</span><span class="stringliteral">    screensize = os.getenv(&#39;SCREENSIZE&#39;</span>)</div>
<div class="line"><span class="lineno">  148</span>    path: str = imgSrc</div>
<div class="line"><span class="lineno">  149</span>    <span class="keywordflow">for</span> file <span class="keywordflow">in</span> glob.glob(path):</div>
<div class="line"><span class="lineno">  150</span>        <span class="keyword">global</span> dummy</div>
<div class="line"><span class="lineno">  151</span>        dummy = cv2.imread(file)</div>
<div class="line"><span class="lineno">  152</span>        cv2.imshow(name, dummy)</div>
<div class="line"><span class="lineno">  153</span>        <span class="keywordflow">if</span> x <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> y <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> width <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> length <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  154</span>            appname: str = name</div>
<div class="line"><span class="lineno">  155</span>            xpos: int = x</div>
<div class="line"><span class="lineno">  156</span>            ypos: int = y</div>
<div class="line"><span class="lineno">  157</span>            <span class="keywordflow">if</span> width <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  158</span>                width = int((screensize[0]/10)*9)</div>
<div class="line"><span class="lineno">  159</span>            <span class="keywordflow">if</span> length <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  160</span>                length = int((screensize[1]/10)*9)</div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>            <span class="keyword">def </span>enumHandler(hwnd, lParam):</div>
<div class="line"><span class="lineno">  163</span>                <span class="keywordflow">if</span> win32gui.IsWindowVisible(hwnd):  <span class="comment"># type: ignore</span></div>
<div class="line"><span class="lineno">  164</span>                    <span class="comment"># type: ignore</span></div>
<div class="line"><span class="lineno">  165</span>                    <span class="keywordflow">if</span> appname <span class="keywordflow">in</span> win32gui.GetWindowText(hwnd):</div>
<div class="line"><span class="lineno">  166</span>                        win32gui.MoveWindow(</div>
<div class="line"><span class="lineno">  167</span>                            hwnd, xpos, ypos, width, length, <span class="keyword">True</span>)  <span class="comment"># type: ignore</span></div>
<div class="line"><span class="lineno">  168</span>            win32gui.EnumWindows(enumHandler, <span class="keywordtype">None</span>)  <span class="comment"># type: ignore</span></div>
<div class="line"><span class="lineno">  169</span>        k = cv2.waitKey(33)</div>
<div class="line"><span class="lineno">  170</span>        cv2.setWindowProperty(</div>
<div class="line"><span class="lineno">  171</span>            name, cv2.WND_PROP_FULLSCREEN, cv2.WINDOW_FULLSCREEN)</div>
<div class="line"><span class="lineno">  172</span>        <span class="keywordflow">if</span> k == 27:</div>
<div class="line"><span class="lineno">  173</span>            <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  174</span>        <span class="keywordflow">elif</span> k == -1:</div>
<div class="line"><span class="lineno">  175</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  176</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  177</span>            print(k)</div>
<div class="line"><span class="lineno">  178</span>            cv2.destroyAllWindows()</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae1c540b83755223d324045f0383ce68d" name="ae1c540b83755223d324045f0383ce68d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1c540b83755223d324045f0383ce68d">&#9670;&#160;</a></span>getWindow()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> bool system_operations.getWindow </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>args</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">The getWindow function is used to find the window of Známý (the game) and activate it.
It also checks if the file 'banner.png' exists in the assets folder.

:return: If error occured
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/d18/system__operations_8py_source.html#l00014">14</a> of file <a class="el" href="../../dd/d18/system__operations_8py_source.html">system_operations.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   14</span><span class="keyword">def </span>getWindow(args) -&gt; bool:</div>
<div class="line"><span class="lineno">   15</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   16</span><span class="stringliteral">    The getWindow function </span><span class="keywordflow">is</span> used to find the window of Známý (the game) <span class="keywordflow">and</span> activate it.</div>
<div class="line"><span class="lineno">   17</span>    It also checks <span class="keywordflow">if</span> the file <span class="stringliteral">&#39;banner.png&#39;</span> exists <span class="keywordflow">in</span> the assets folder.</div>
<div class="line"><span class="lineno">   18</span> </div>
<div class="line"><span class="lineno">   19</span>    :<span class="keywordflow">return</span>: If error occured</div>
<div class="line"><span class="lineno">   20</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   21</span><span class="stringliteral">    dummy = </span><span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">   22</span>    cv2.namedWindow(<span class="stringliteral">&#39;frame2&#39;</span>, cv2.WND_PROP_FULLSCREEN)</div>
<div class="line"><span class="lineno">   23</span>    cv2.setWindowProperty(</div>
<div class="line"><span class="lineno">   24</span>        <span class="stringliteral">&#39;frame2&#39;</span>, cv2.WND_PROP_FULLSCREEN, cv2.WINDOW_FULLSCREEN)</div>
<div class="line"><span class="lineno">   25</span>    test: str = <span class="stringliteral">&quot;assets/banner.png&quot;</span></div>
<div class="line"><span class="lineno">   26</span>    <span class="keywordflow">for</span> file <span class="keywordflow">in</span> glob.glob(test):</div>
<div class="line"><span class="lineno">   27</span>        dummy = cv2.imread(file)</div>
<div class="line"><span class="lineno">   28</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">   29</span>        cv2.imshow(<span class="stringliteral">&quot;Image&quot;</span>, dummy)</div>
<div class="line"><span class="lineno">   30</span>    <span class="keywordflow">except</span> cv2.error:</div>
<div class="line"><span class="lineno">   31</span>        error_get(cv2.error(<span class="stringliteral">&#39;File is corrupt (probably \&#39;banner.png\&#39;)&#39;</span>), [</div>
<div class="line"><span class="lineno">   32</span>            get_line_number()])</div>
<div class="line"><span class="lineno">   33</span>        <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><span class="lineno">   34</span>    cv2.waitKey(1)</div>
<div class="line"><span class="lineno">   35</span>    sleep(0.1)</div>
<div class="line"><span class="lineno">   36</span>    cv2.destroyWindow(<span class="stringliteral">&quot;Image&quot;</span>)</div>
<div class="line"><span class="lineno">   37</span>    <span class="keywordflow">if</span> args.test <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   38</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">   39</span>            window = pygetwindow.getWindowsWithTitle(<span class="stringliteral">&#39;ZnámE&#39;</span>)[0]</div>
<div class="line"><span class="lineno">   40</span>            window.activate()</div>
<div class="line"><span class="lineno">   41</span>            <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><span class="lineno">   42</span>        <span class="keywordflow">except</span> IndexError:</div>
<div class="line"><span class="lineno">   43</span>            error_get(IndexError(</div>
<div class="line"><span class="lineno">   44</span>                <span class="stringliteral">&#39;Possible solution; run in cmd or python aplication not ide or put arguments \&#39;--test\&#39;&#39;</span>), [get_line_number()])</div>
<div class="line"><span class="lineno">   45</span>            <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><span class="lineno">   46</span>    <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><span class="lineno">   47</span> </div>
<div class="line"><span class="lineno">   48</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa3fb45e81ca75b65dfa7ad1c6819300c" name="aa3fb45e81ca75b65dfa7ad1c6819300c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3fb45e81ca75b65dfa7ad1c6819300c">&#9670;&#160;</a></span>isUserAdmin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def system_operations.isUserAdmin </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">The isUserAdmin function checks to see if the user running this script is an admin.
This is for Windows only.
:return: A boolean value
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/d18/system__operations_8py_source.html#l00049">49</a> of file <a class="el" href="../../dd/d18/system__operations_8py_source.html">system_operations.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   49</span><span class="keyword">def </span>isUserAdmin():</div>
<div class="line"><span class="lineno">   50</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   51</span><span class="stringliteral">    The isUserAdmin function checks to see </span><span class="keywordflow">if</span> the user running this script <span class="keywordflow">is</span> an admin.</div>
<div class="line"><span class="lineno">   52</span>    This <span class="keywordflow">is</span> <span class="keywordflow">for</span> Windows only.</div>
<div class="line"><span class="lineno">   53</span>    :<span class="keywordflow">return</span>: A boolean value</div>
<div class="line"><span class="lineno">   54</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   55</span><span class="stringliteral">    </span><span class="keywordflow">if</span> os.name == <span class="stringliteral">&#39;nt&#39;</span>:</div>
<div class="line"><span class="lineno">   56</span>        <span class="keyword">import</span> ctypes</div>
<div class="line"><span class="lineno">   57</span>        <span class="comment"># WARNING: requires Windows XP SP2 or higher!</span></div>
<div class="line"><span class="lineno">   58</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">   59</span>            <span class="keywordflow">return</span> ctypes.windll.shell32.IsUserAnAdmin()</div>
<div class="line"><span class="lineno">   60</span>        <span class="keywordflow">except</span>:</div>
<div class="line"><span class="lineno">   61</span>            traceback.print_exc()</div>
<div class="line"><span class="lineno">   62</span>            print(<span class="stringliteral">&quot;Admin check failed, assuming not an admin.&quot;</span>)</div>
<div class="line"><span class="lineno">   63</span>            <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><span class="lineno">   64</span>    <span class="keywordflow">elif</span> os.name == <span class="stringliteral">&#39;posix&#39;</span>:</div>
<div class="line"><span class="lineno">   65</span>        <span class="comment"># Check for root on Posix</span></div>
<div class="line"><span class="lineno">   66</span>        <span class="keywordflow">return</span> os.getuid() == 0</div>
<div class="line"><span class="lineno">   67</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   68</span>        <span class="keywordflow">raise</span> RuntimeError(</div>
<div class="line"><span class="lineno">   69</span>            <span class="stringliteral">&quot;Unsupported operating system for this module: %s&quot;</span> % (os.name,))</div>
<div class="line"><span class="lineno">   70</span> </div>
<div class="line"><span class="lineno">   71</span> </div>
</div><!-- fragment --><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../de/d05/namespacesystem__operations_aa3fb45e81ca75b65dfa7ad1c6819300c_icgraph.png" border="0" usemap="#ade/d05/namespacesystem__operations_aa3fb45e81ca75b65dfa7ad1c6819300c_icgraph" alt=""/></div>
</div>

</div>
</div>
<a id="ad91b2c3c346993d5f478e23670f61aeb" name="ad91b2c3c346993d5f478e23670f61aeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad91b2c3c346993d5f478e23670f61aeb">&#9670;&#160;</a></span>runAsAdmin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def system_operations.runAsAdmin </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cmdLine</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>wait</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">The runAsAdmin function is a simple function that will run your python script as the Administrator.
This function will attempt to do the following:
:param cmdLine: Pass arguments to the executable
:param wait: Determine whether the function should wait for the process to finish or not
:return: The process handle of the elevated process
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/d18/system__operations_8py_source.html#l00072">72</a> of file <a class="el" href="../../dd/d18/system__operations_8py_source.html">system_operations.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   72</span><span class="keyword">def </span>runAsAdmin(cmdLine=None, wait=True):</div>
<div class="line"><span class="lineno">   73</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   74</span><span class="stringliteral">    The runAsAdmin function </span><span class="keywordflow">is</span> a simple function that will run your python script <span class="keyword">as</span> the Administrator.</div>
<div class="line"><span class="lineno">   75</span>    This function will attempt to do the following:</div>
<div class="line"><span class="lineno">   76</span>    :param cmdLine: Pass arguments to the executable</div>
<div class="line"><span class="lineno">   77</span>    :param wait: Determine whether the function should wait <span class="keywordflow">for</span> the process to finish <span class="keywordflow">or</span> <span class="keywordflow">not</span></div>
<div class="line"><span class="lineno">   78</span>    :<span class="keywordflow">return</span>: The process handle of the elevated process</div>
<div class="line"><span class="lineno">   79</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   80</span><span class="stringliteral">    </span><span class="keywordflow">if</span> os.name != <span class="stringliteral">&#39;nt&#39;</span>:</div>
<div class="line"><span class="lineno">   81</span>        <span class="keywordflow">raise</span> RuntimeError(</div>
<div class="line"><span class="lineno">   82</span>            <span class="stringliteral">&quot;This function is only implemented on Windows.&quot;</span>)</div>
<div class="line"><span class="lineno">   83</span> </div>
<div class="line"><span class="lineno">   84</span>    <span class="keyword">import</span> win32api</div>
<div class="line"><span class="lineno">   85</span>    <span class="keyword">import</span> win32con</div>
<div class="line"><span class="lineno">   86</span>    <span class="keyword">import</span> win32event</div>
<div class="line"><span class="lineno">   87</span>    <span class="keyword">import</span> win32process</div>
<div class="line"><span class="lineno">   88</span>    <span class="keyword">from</span> win32com.shell.shell <span class="keyword">import</span> ShellExecuteEx  <span class="comment"># type: ignore</span></div>
<div class="line"><span class="lineno">   89</span>    <span class="keyword">from</span> win32com.shell <span class="keyword">import</span> shellcon  <span class="comment"># type: ignore</span></div>
<div class="line"><span class="lineno">   90</span> </div>
<div class="line"><span class="lineno">   91</span>    python_exe = sys.executable</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>    <span class="keywordflow">if</span> cmdLine <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   94</span>        cmdLine = [python_exe] + sys.argv</div>
<div class="line"><span class="lineno">   95</span>    <span class="keywordflow">elif</span> type(cmdLine) <span class="keywordflow">not</span> <span class="keywordflow">in</span> (ctypes.TupleType, ctypes.ListType):</div>
<div class="line"><span class="lineno">   96</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;cmdLine is not a sequence.&quot;</span>)</div>
<div class="line"><span class="lineno">   97</span>    cmd = <span class="stringliteral">&#39;&quot;%s&quot;&#39;</span> % (cmdLine[0],)</div>
<div class="line"><span class="lineno">   98</span>    params = <span class="stringliteral">&quot; &quot;</span>.join([<span class="stringliteral">&#39;&quot;%s&quot;&#39;</span> % (x,) <span class="keywordflow">for</span> x <span class="keywordflow">in</span> cmdLine[1:]])</div>
<div class="line"><span class="lineno">   99</span>    cmdDir = <span class="stringliteral">&#39;&#39;</span></div>
<div class="line"><span class="lineno">  100</span>    showCmd = win32con.SW_SHOWNORMAL</div>
<div class="line"><span class="lineno">  101</span>    lpVerb = <span class="stringliteral">&#39;runas&#39;</span></div>
<div class="line"><span class="lineno">  102</span>    procInfo = ShellExecuteEx(nShow=showCmd,</div>
<div class="line"><span class="lineno">  103</span>                              fMask=shellcon.SEE_MASK_NOCLOSEPROCESS,</div>
<div class="line"><span class="lineno">  104</span>                              lpVerb=lpVerb,</div>
<div class="line"><span class="lineno">  105</span>                              lpFile=cmd,</div>
<div class="line"><span class="lineno">  106</span>                              lpParameters=params)</div>
<div class="line"><span class="lineno">  107</span>    <span class="keywordflow">if</span> wait:</div>
<div class="line"><span class="lineno">  108</span>        procHandle = procInfo[<span class="stringliteral">&#39;hProcess&#39;</span>]</div>
<div class="line"><span class="lineno">  109</span>        obj = win32event.WaitForSingleObject(</div>
<div class="line"><span class="lineno">  110</span>            procHandle, win32event.INFINITE)</div>
<div class="line"><span class="lineno">  111</span>        rc = win32process.GetExitCodeProcess(procHandle)</div>
<div class="line"><span class="lineno">  112</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  113</span>        rc = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  114</span>    <span class="keywordflow">return</span> rc</div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span> </div>
</div><!-- fragment --><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="../../closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../de/d05/namespacesystem__operations_ad91b2c3c346993d5f478e23670f61aeb_icgraph.png" border="0" usemap="#ade/d05/namespacesystem__operations_ad91b2c3c346993d5f478e23670f61aeb_icgraph" alt=""/></div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../de/d05/namespacesystem__operations.html">system_operations</a></li>
    <li class="footer">Generated on Sun Apr 30 2023 16:09:14 for ZnamE by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
